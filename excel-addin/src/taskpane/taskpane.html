<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EngiVault</title>
    <link rel="stylesheet" href="taskpane.css">
    
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>EngiVault</h1>
            <p class="tagline">Professional Engineering Calculations</p>
        </header>

        <!-- API Key Configuration -->
        <section id="config-section" class="section">
            <h2>Configuration</h2>
            <div class="form-group">
                <label for="api-key">API Key</label>
                <input type="password" id="api-key" placeholder="Enter your API key">
                <button id="save-key" class="btn btn-primary">Save API Key</button>
                <p class="help-text">Get your API key at <a href="https://engivault.com" target="_blank">engivault.com</a></p>
            </div>
            <div id="config-status" class="status-message"></div>
        </section>

        <!-- Quick Calculator -->
        <section id="calculator-section" class="section">
            <h2>Quick Calculator</h2>
            <div class="tabs">
                <button class="tab-btn active" data-tab="pressure">Pressure Drop</button>
                <button class="tab-btn" data-tab="pump">Pump Power</button>
                <button class="tab-btn" data-tab="heat">Heat Transfer</button>
            </div>

            <!-- Pressure Drop Calculator -->
            <div id="pressure-tab" class="tab-content active">
                <h3>Pressure Drop Calculator</h3>
                <div class="form-group">
                    <label>Flow Rate (m³/s)</label>
                    <input type="number" id="pd-flow" step="0.001" value="0.01">
                </div>
                <div class="form-group">
                    <label>Pipe Diameter (m)</label>
                    <input type="number" id="pd-diameter" step="0.001" value="0.1">
                </div>
                <div class="form-group">
                    <label>Pipe Length (m)</label>
                    <input type="number" id="pd-length" value="100">
                </div>
                <div class="form-group">
                    <label>Fluid Density (kg/m³)</label>
                    <input type="number" id="pd-density" value="1000">
                </div>
                <div class="form-group">
                    <label>Viscosity (Pa·s)</label>
                    <input type="number" id="pd-viscosity" step="0.00001" value="0.001">
                </div>
                <button id="calc-pressure" class="btn btn-calculate">Calculate</button>
                <div id="pressure-result" class="result-box"></div>
            </div>

            <!-- Pump Power Calculator -->
            <div id="pump-tab" class="tab-content">
                <h3>Pump Power Calculator</h3>
                <div class="form-group">
                    <label>Flow Rate (m³/s)</label>
                    <input type="number" id="pp-flow" step="0.001" value="0.05">
                </div>
                <div class="form-group">
                    <label>Head (m)</label>
                    <input type="number" id="pp-head" value="50">
                </div>
                <div class="form-group">
                    <label>Efficiency (0-1)</label>
                    <input type="number" id="pp-efficiency" step="0.01" value="0.8">
                </div>
                <button id="calc-pump" class="btn btn-calculate">Calculate</button>
                <div id="pump-result" class="result-box"></div>
            </div>

            <!-- Heat Transfer Calculator -->
            <div id="heat-tab" class="tab-content">
                <h3>LMTD Calculator</h3>
                <div class="form-group">
                    <label>Hot Inlet (K)</label>
                    <input type="number" id="ht-hotin" value="373">
                </div>
                <div class="form-group">
                    <label>Hot Outlet (K)</label>
                    <input type="number" id="ht-hotout" value="323">
                </div>
                <div class="form-group">
                    <label>Cold Inlet (K)</label>
                    <input type="number" id="ht-coldin" value="293">
                </div>
                <div class="form-group">
                    <label>Cold Outlet (K)</label>
                    <input type="number" id="ht-coldout" value="333">
                </div>
                <button id="calc-heat" class="btn btn-calculate">Calculate</button>
                <div id="heat-result" class="result-box"></div>
            </div>
        </section>

        <!-- Function Reference -->
        <section id="reference-section" class="section">
            <h2>Available Functions</h2>
            <div class="function-list">
                <div class="function-item">
                    <code>=ENGIVAULT.PRESSUREDROP(flow, dia, len, dens, visc)</code>
                    <p>Calculate pressure drop in pipes</p>
                </div>
                <div class="function-item">
                    <code>=ENGIVAULT.PUMPPOWER(flow, head, eff)</code>
                    <p>Calculate pump power requirements</p>
                </div>
                <div class="function-item">
                    <code>=ENGIVAULT.LMTD(hotIn, hotOut, coldIn, coldOut)</code>
                    <p>Calculate log mean temperature difference</p>
                </div>
                <div class="function-item">
                    <code>=ENGIVAULT.VELOCITY(flow, diameter)</code>
                    <p>Calculate flow velocity</p>
                </div>
                <div class="function-item">
                    <code>=ENGIVAULT.REYNOLDS(flow, dia, dens, visc)</code>
                    <p>Calculate Reynolds number</p>
                </div>
                <div class="function-item">
                    <code>=ENGIVAULT.WATERDENSITY(temp)</code>
                    <p>Get water density at temperature</p>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <p>&copy; 2024 EngiVault. <a href="https://engivault.com" target="_blank">Documentation</a></p>
        </footer>
    </div>

    <script src="taskpane.js"></script>
</body>
</html>

